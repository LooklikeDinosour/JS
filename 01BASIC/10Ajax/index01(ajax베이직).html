<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <script>

        //동기 => 순차적으로 실행
        //비동기 =>? 비순차적으로 실행

        //순서 1,2 hi.txt순으로 실행됐음 순서 잘 파악하기 

        // console.log(1);

        // fetch('hi.txt').then(function(response) {

        //     response.text().then(function(text) {
        //         console.log(text);
        //     })
        // })

        // console.log(2);

        //2nd
        //fetch를 사용하면 promise 객체를 반환 (상태를 가지고 있는 객체)
        //pending = 대기중
        //fullfilled = 성공
        //reject = 실패


        // fetch 자체로는 promise안불러와짐. 변수명 바꿔봤는데 promise 객체로 반환됌. 
        var promise = fetch('hi.txt'); 
        promise.then() //콜백

        //fetch를 호출하여 promise로 반환받으면 promise객체안의 then(콜백)함수를 사용할 수 있다.
        //콜백함수 콜하면 백 받을 수있는 약속된 함수 (실행결과를 돌려받는 함수)
        
        fetch('hi.txt').then(xxx)

        //콜백함수 
        function xxx(response) { // response의 body에 데이터 담김 
            console.log(response); //response 실행결과값들이 담겨있음
        }
        
        //3nd
        //text()는 body에 있는 데이터를 문자열로 변환 - return: Promise객체
        //json()는 body에 있는 데이터를 Object로 변환 - return: Promise객체
        /*
        fetch('hi.txt').then(function(response) {

            console.log(response.text());
        })
        */

        
        fetch('hi.txt').then(function(response){
            console.log(response);

            if(response.status != 200) {
                alert('통신에 실패했습니다.');
                return;
            }

            response.text().then(function(data) {
                console.log(data);

            })
        })
        

        
        fetch('hi.txt')
        .then(function(response) {

            if(response.status != 200) {
                console.log('통신에 실패했습니다.');
                return;
            }

            return response.text(); // 이 결과는 fetch함수의 리턴으로 연결 (promise로)
        
        }).then(function(data){
            console.log(1);
            return data;
        }).then(function(data){
            console.log(2);
            return data;
        }).then(function(data){
            console.log(data);
        }).catch(function(e){
            console.log(e); //에러시에 실행됨.
        }).finally



    </script>
    
</body>
</html>